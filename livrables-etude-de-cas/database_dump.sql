--
-- PostgreSQL database dump
--

\restrict j2eRSqslIgMGbIRxsNCAiMERzaUXZuhZtcTjbfC9QRMLXnL1MbYssxwKou0pk7C

-- Dumped from database version 17.6 (Debian 17.6-1.pgdg13+1)
-- Dumped by pg_dump version 17.6 (Debian 17.6-1.pgdg13+1)

SET statement_timeout = 0;
SET lock_timeout = 0;
SET idle_in_transaction_session_timeout = 0;
SET transaction_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SELECT pg_catalog.set_config('search_path', '', false);
SET check_function_bodies = false;
SET xmloption = content;
SET client_min_messages = warning;
SET row_security = off;

DROP DATABASE IF EXISTS mpmt;
--
-- Name: mpmt; Type: DATABASE; Schema: -; Owner: mpmt
--

CREATE DATABASE mpmt WITH TEMPLATE = template0 ENCODING = 'UTF8' LOCALE_PROVIDER = libc LOCALE = 'en_US.utf8';


ALTER DATABASE mpmt OWNER TO mpmt;

\unrestrict j2eRSqslIgMGbIRxsNCAiMERzaUXZuhZtcTjbfC9QRMLXnL1MbYssxwKou0pk7C
\connect mpmt
\restrict j2eRSqslIgMGbIRxsNCAiMERzaUXZuhZtcTjbfC9QRMLXnL1MbYssxwKou0pk7C

SET statement_timeout = 0;
SET lock_timeout = 0;
SET idle_in_transaction_session_timeout = 0;
SET transaction_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SELECT pg_catalog.set_config('search_path', '', false);
SET check_function_bodies = false;
SET xmloption = content;
SET client_min_messages = warning;
SET row_security = off;

SET default_tablespace = '';

SET default_table_access_method = heap;

--
-- Name: project_memberships; Type: TABLE; Schema: public; Owner: mpmt
--

CREATE TABLE public.project_memberships (
    accepted_at timestamp(6) without time zone,
    id bigint NOT NULL,
    invited_at timestamp(6) without time zone,
    invited_by bigint,
    project_id bigint NOT NULL,
    user_id bigint NOT NULL,
    role character varying(255) NOT NULL,
    CONSTRAINT project_memberships_role_check CHECK (((role)::text = ANY ((ARRAY['ADMIN'::character varying, 'MEMBER'::character varying, 'VIEWER'::character varying])::text[])))
);


ALTER TABLE public.project_memberships OWNER TO mpmt;

--
-- Name: project_memberships_id_seq; Type: SEQUENCE; Schema: public; Owner: mpmt
--

ALTER TABLE public.project_memberships ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.project_memberships_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: projects; Type: TABLE; Schema: public; Owner: mpmt
--

CREATE TABLE public.projects (
    start_date date,
    created_at timestamp(6) without time zone NOT NULL,
    id bigint NOT NULL,
    updated_at timestamp(6) without time zone,
    description text,
    name character varying(255) NOT NULL
);


ALTER TABLE public.projects OWNER TO mpmt;

--
-- Name: projects_id_seq; Type: SEQUENCE; Schema: public; Owner: mpmt
--

ALTER TABLE public.projects ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.projects_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: task_assignations; Type: TABLE; Schema: public; Owner: mpmt
--

CREATE TABLE public.task_assignations (
    assigned_at timestamp(6) without time zone NOT NULL,
    task_id bigint NOT NULL,
    user_id bigint NOT NULL
);


ALTER TABLE public.task_assignations OWNER TO mpmt;

--
-- Name: task_history; Type: TABLE; Schema: public; Owner: mpmt
--

CREATE TABLE public.task_history (
    changed_at timestamp(6) without time zone NOT NULL,
    changed_by bigint NOT NULL,
    id bigint NOT NULL,
    task_id bigint NOT NULL,
    field character varying(255),
    new_value text,
    old_value text
);


ALTER TABLE public.task_history OWNER TO mpmt;

--
-- Name: task_history_id_seq; Type: SEQUENCE; Schema: public; Owner: mpmt
--

ALTER TABLE public.task_history ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.task_history_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: tasks; Type: TABLE; Schema: public; Owner: mpmt
--

CREATE TABLE public.tasks (
    completed_date date,
    due_date date,
    created_at timestamp(6) without time zone NOT NULL,
    created_by bigint NOT NULL,
    id bigint NOT NULL,
    project_id bigint NOT NULL,
    updated_at timestamp(6) without time zone,
    description text,
    name character varying(255) NOT NULL,
    priority character varying(255) NOT NULL,
    status character varying(255) NOT NULL,
    CONSTRAINT tasks_priority_check CHECK (((priority)::text = ANY ((ARRAY['LOW'::character varying, 'MEDIUM'::character varying, 'HIGH'::character varying, 'URGENT'::character varying])::text[]))),
    CONSTRAINT tasks_status_check CHECK (((status)::text = ANY ((ARRAY['TODO'::character varying, 'DOING'::character varying, 'DONE'::character varying, 'BLOCKED'::character varying])::text[])))
);


ALTER TABLE public.tasks OWNER TO mpmt;

--
-- Name: tasks_id_seq; Type: SEQUENCE; Schema: public; Owner: mpmt
--

ALTER TABLE public.tasks ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.tasks_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: users; Type: TABLE; Schema: public; Owner: mpmt
--

CREATE TABLE public.users (
    created_at timestamp(6) without time zone NOT NULL,
    id bigint NOT NULL,
    updated_at timestamp(6) without time zone,
    username character varying(50) NOT NULL,
    email character varying(320) NOT NULL,
    password character varying(255) NOT NULL
);


ALTER TABLE public.users OWNER TO mpmt;

--
-- Name: users_id_seq; Type: SEQUENCE; Schema: public; Owner: mpmt
--

ALTER TABLE public.users ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.users_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Data for Name: project_memberships; Type: TABLE DATA; Schema: public; Owner: mpmt
--

INSERT INTO public.project_memberships VALUES (NULL, 1, NULL, 1, 1, 1, 'ADMIN');
INSERT INTO public.project_memberships VALUES (NULL, 2, NULL, 1, 1, 2, 'MEMBER');
INSERT INTO public.project_memberships VALUES (NULL, 3, NULL, 1, 1, 3, 'MEMBER');
INSERT INTO public.project_memberships VALUES (NULL, 4, NULL, 1, 1, 4, 'VIEWER');
INSERT INTO public.project_memberships VALUES (NULL, 5, NULL, 1, 2, 1, 'ADMIN');
INSERT INTO public.project_memberships VALUES (NULL, 6, NULL, 1, 2, 2, 'MEMBER');
INSERT INTO public.project_memberships VALUES (NULL, 7, NULL, 1, 3, 1, 'ADMIN');
INSERT INTO public.project_memberships VALUES (NULL, 8, NULL, 1, 3, 3, 'MEMBER');


--
-- Data for Name: projects; Type: TABLE DATA; Schema: public; Owner: mpmt
--

INSERT INTO public.projects VALUES ('2025-07-01', '2025-09-08 11:22:49.573932', 1, '2025-09-08 11:22:49.573932', 'V2 de la plateforme MPMT', 'Projet MPMT');
INSERT INTO public.projects VALUES ('2025-08-01', '2025-09-08 11:22:49.573932', 2, '2025-09-08 11:22:49.573932', 'Refonte du site web de l''entreprise familiale', 'Refonte Site Web');
INSERT INTO public.projects VALUES ('2025-09-01', '2025-09-08 11:22:49.573932', 3, '2025-09-08 11:22:49.573932', 'Développement d''une application mobile pour Android', 'App Mobile');


--
-- Data for Name: task_assignations; Type: TABLE DATA; Schema: public; Owner: mpmt
--

INSERT INTO public.task_assignations VALUES ('2025-09-08 11:22:49.764234', 1, 1);
INSERT INTO public.task_assignations VALUES ('2025-09-08 11:22:49.764234', 2, 2);
INSERT INTO public.task_assignations VALUES ('2025-09-08 11:22:49.764234', 3, 3);
INSERT INTO public.task_assignations VALUES ('2025-09-08 11:22:49.764234', 4, 3);
INSERT INTO public.task_assignations VALUES ('2025-09-08 11:22:49.764234', 5, 1);
INSERT INTO public.task_assignations VALUES ('2025-09-08 11:22:49.764234', 6, 2);
INSERT INTO public.task_assignations VALUES ('2025-09-08 11:22:49.764234', 7, 1);


--
-- Data for Name: task_history; Type: TABLE DATA; Schema: public; Owner: mpmt
--

INSERT INTO public.task_history VALUES ('2025-07-02 09:30:00', 1, 1, 1, 'name', 'Configurer la BDD', 'Setup BDD');
INSERT INTO public.task_history VALUES ('2025-07-03 10:15:00', 1, 2, 1, 'status', 'DOING', 'TODO');
INSERT INTO public.task_history VALUES ('2025-07-14 16:45:00', 1, 3, 1, 'status', 'DONE', 'DOING');
INSERT INTO public.task_history VALUES ('2025-07-15 08:20:00', 1, 4, 2, 'status', 'DOING', 'TODO');
INSERT INTO public.task_history VALUES ('2025-07-16 14:30:00', 1, 5, 2, 'priority', 'HIGH', 'MEDIUM');
INSERT INTO public.task_history VALUES ('2025-07-20 11:00:00', 2, 6, 3, 'status', 'DOING', 'TODO');
INSERT INTO public.task_history VALUES ('2025-07-21 15:20:00', 2, 7, 3, 'description', 'Créer les maquettes de l''interface utilisateur', 'Créer les maquettes');
INSERT INTO public.task_history VALUES ('2025-08-05 09:45:00', 1, 8, 5, 'status', 'DOING', 'TODO');
INSERT INTO public.task_history VALUES ('2025-08-10 13:15:00', 1, 9, 5, 'due_date', '2025-08-30', '2025-08-25');


--
-- Data for Name: tasks; Type: TABLE DATA; Schema: public; Owner: mpmt
--

INSERT INTO public.tasks VALUES ('2025-07-14', '2025-07-15', '2025-09-08 11:22:49.742234', 1, 1, 1, '2025-09-08 11:22:49.742234', 'Mettre en place le schéma de base de données et les données initiales', 'Configurer la BDD', 'HIGH', 'DONE');
INSERT INTO public.tasks VALUES (NULL, '2025-07-30', '2025-09-08 11:22:49.742234', 1, 2, 1, '2025-09-08 11:22:49.742234', 'Développer les endpoints REST pour la gestion des utilisateurs', 'Créer les APIs', 'HIGH', 'DOING');
INSERT INTO public.tasks VALUES (NULL, '2025-08-15', '2025-09-08 11:22:49.742234', 2, 3, 1, '2025-09-08 11:22:49.742234', 'Créer les maquettes de l''interface utilisateur', 'Designer l''interface', 'MEDIUM', 'TODO');
INSERT INTO public.tasks VALUES (NULL, '2025-08-28', '2025-09-08 11:22:49.742234', 3, 4, 1, '2025-09-08 11:22:49.742234', 'Rédiger les tests unitaires et d''intégration', 'Écrire les tests', 'MEDIUM', 'TODO');
INSERT INTO public.tasks VALUES (NULL, '2025-08-20', '2025-09-08 11:22:49.742234', 1, 5, 2, '2025-09-08 11:22:49.742234', 'Concevoir la nouvelle mise en page de la page d''accueil', 'Design page d''accueil', 'HIGH', 'DOING');
INSERT INTO public.tasks VALUES (NULL, '2025-09-15', '2025-09-08 11:22:49.742234', 2, 6, 2, '2025-09-08 11:22:49.742234', 'Migrer le contenu de l''ancien site web', 'Migration contenu', 'LOW', 'TODO');
INSERT INTO public.tasks VALUES (NULL, '2025-09-30', '2025-09-08 11:22:49.742234', 1, 7, 3, '2025-09-08 11:22:49.742234', 'Concevoir l''architecture de l''application mobile', 'Architecture app', 'URGENT', 'TODO');


--
-- Data for Name: users; Type: TABLE DATA; Schema: public; Owner: mpmt
--

INSERT INTO public.users VALUES ('2025-09-08 11:22:48.573052', 1, '2025-09-08 11:22:48.573052', 'admin', 'admin@mpmt.com', 'password');
INSERT INTO public.users VALUES ('2025-09-08 11:22:48.573052', 2, '2025-09-08 11:22:48.573052', 'michel', 'michel.dupont@example.com', 'password');
INSERT INTO public.users VALUES ('2025-09-08 11:22:48.573052', 3, '2025-09-08 11:22:48.573052', 'marie', 'marie.martin@example.com', 'password');
INSERT INTO public.users VALUES ('2025-09-08 11:22:48.573052', 4, '2025-09-08 11:22:48.573052', 'pierre', 'pierre.durand@example.com', 'password');


--
-- Name: project_memberships_id_seq; Type: SEQUENCE SET; Schema: public; Owner: mpmt
--

SELECT pg_catalog.setval('public.project_memberships_id_seq', 8, true);


--
-- Name: projects_id_seq; Type: SEQUENCE SET; Schema: public; Owner: mpmt
--

SELECT pg_catalog.setval('public.projects_id_seq', 3, true);


--
-- Name: task_history_id_seq; Type: SEQUENCE SET; Schema: public; Owner: mpmt
--

SELECT pg_catalog.setval('public.task_history_id_seq', 9, true);


--
-- Name: tasks_id_seq; Type: SEQUENCE SET; Schema: public; Owner: mpmt
--

SELECT pg_catalog.setval('public.tasks_id_seq', 7, true);


--
-- Name: users_id_seq; Type: SEQUENCE SET; Schema: public; Owner: mpmt
--

SELECT pg_catalog.setval('public.users_id_seq', 4, true);


--
-- Name: project_memberships project_memberships_pkey; Type: CONSTRAINT; Schema: public; Owner: mpmt
--

ALTER TABLE ONLY public.project_memberships
    ADD CONSTRAINT project_memberships_pkey PRIMARY KEY (id);


--
-- Name: project_memberships project_memberships_project_id_user_id_key; Type: CONSTRAINT; Schema: public; Owner: mpmt
--

ALTER TABLE ONLY public.project_memberships
    ADD CONSTRAINT project_memberships_project_id_user_id_key UNIQUE (project_id, user_id);


--
-- Name: projects projects_pkey; Type: CONSTRAINT; Schema: public; Owner: mpmt
--

ALTER TABLE ONLY public.projects
    ADD CONSTRAINT projects_pkey PRIMARY KEY (id);


--
-- Name: task_assignations task_assignations_pkey; Type: CONSTRAINT; Schema: public; Owner: mpmt
--

ALTER TABLE ONLY public.task_assignations
    ADD CONSTRAINT task_assignations_pkey PRIMARY KEY (task_id, user_id);


--
-- Name: task_history task_history_pkey; Type: CONSTRAINT; Schema: public; Owner: mpmt
--

ALTER TABLE ONLY public.task_history
    ADD CONSTRAINT task_history_pkey PRIMARY KEY (id);


--
-- Name: tasks tasks_pkey; Type: CONSTRAINT; Schema: public; Owner: mpmt
--

ALTER TABLE ONLY public.tasks
    ADD CONSTRAINT tasks_pkey PRIMARY KEY (id);


--
-- Name: users users_email_key; Type: CONSTRAINT; Schema: public; Owner: mpmt
--

ALTER TABLE ONLY public.users
    ADD CONSTRAINT users_email_key UNIQUE (email);


--
-- Name: users users_pkey; Type: CONSTRAINT; Schema: public; Owner: mpmt
--

ALTER TABLE ONLY public.users
    ADD CONSTRAINT users_pkey PRIMARY KEY (id);


--
-- Name: users users_username_key; Type: CONSTRAINT; Schema: public; Owner: mpmt
--

ALTER TABLE ONLY public.users
    ADD CONSTRAINT users_username_key UNIQUE (username);


--
-- Name: task_history fk25h9b68g60qf4qske77bm7imb; Type: FK CONSTRAINT; Schema: public; Owner: mpmt
--

ALTER TABLE ONLY public.task_history
    ADD CONSTRAINT fk25h9b68g60qf4qske77bm7imb FOREIGN KEY (changed_by) REFERENCES public.users(id);


--
-- Name: project_memberships fk7k1gs1r6ui8ol8oy49abdtutc; Type: FK CONSTRAINT; Schema: public; Owner: mpmt
--

ALTER TABLE ONLY public.project_memberships
    ADD CONSTRAINT fk7k1gs1r6ui8ol8oy49abdtutc FOREIGN KEY (user_id) REFERENCES public.users(id);


--
-- Name: task_assignations fk7u93pqcox6255boaolatjqywa; Type: FK CONSTRAINT; Schema: public; Owner: mpmt
--

ALTER TABLE ONLY public.task_assignations
    ADD CONSTRAINT fk7u93pqcox6255boaolatjqywa FOREIGN KEY (user_id) REFERENCES public.users(id);


--
-- Name: tasks fk9dgm9t7wn4w3gh57h63g712lo; Type: FK CONSTRAINT; Schema: public; Owner: mpmt
--

ALTER TABLE ONLY public.tasks
    ADD CONSTRAINT fk9dgm9t7wn4w3gh57h63g712lo FOREIGN KEY (created_by) REFERENCES public.users(id);


--
-- Name: project_memberships fkd90uwkxsbfhownoqpuw443iqf; Type: FK CONSTRAINT; Schema: public; Owner: mpmt
--

ALTER TABLE ONLY public.project_memberships
    ADD CONSTRAINT fkd90uwkxsbfhownoqpuw443iqf FOREIGN KEY (project_id) REFERENCES public.projects(id);


--
-- Name: task_history fkjqraeud129avhcva579fhioj3; Type: FK CONSTRAINT; Schema: public; Owner: mpmt
--

ALTER TABLE ONLY public.task_history
    ADD CONSTRAINT fkjqraeud129avhcva579fhioj3 FOREIGN KEY (task_id) REFERENCES public.tasks(id);


--
-- Name: task_assignations fkoo1dxsf696qslh1bih3g1p82v; Type: FK CONSTRAINT; Schema: public; Owner: mpmt
--

ALTER TABLE ONLY public.task_assignations
    ADD CONSTRAINT fkoo1dxsf696qslh1bih3g1p82v FOREIGN KEY (task_id) REFERENCES public.tasks(id);


--
-- Name: project_memberships fkoxuwr0xjvwsk8vjicgermqeyi; Type: FK CONSTRAINT; Schema: public; Owner: mpmt
--

ALTER TABLE ONLY public.project_memberships
    ADD CONSTRAINT fkoxuwr0xjvwsk8vjicgermqeyi FOREIGN KEY (invited_by) REFERENCES public.users(id);


--
-- Name: tasks fksfhn82y57i3k9uxww1s007acc; Type: FK CONSTRAINT; Schema: public; Owner: mpmt
--

ALTER TABLE ONLY public.tasks
    ADD CONSTRAINT fksfhn82y57i3k9uxww1s007acc FOREIGN KEY (project_id) REFERENCES public.projects(id);


--
-- PostgreSQL database dump complete
--

\unrestrict j2eRSqslIgMGbIRxsNCAiMERzaUXZuhZtcTjbfC9QRMLXnL1MbYssxwKou0pk7C

